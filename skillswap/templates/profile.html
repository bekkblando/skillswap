{% extends 'base.html' %}
{% block body %}
<body style="background:#00B8D4">
    {% csrf_token %}

{% comment %}
    <nav id="submenu" style="z-index: 10;height:2.6em">
      <div class="nav-wrapper" style="background:#00B8D4; text-align: center;">
                   <a href="{% url 'profile' %}#match" >Matches</a>

<ul class="left hide-on-med-and-down">
          <li><a href="#area" style="height:2.6em">Skills In Area</a></li>
    </ul>
    <ul class="right hide-on-med-and-down">

          <li><a href="{% url 'profile' %}#recommend" >Recommendations</a></li>
</ul>
<a href="#" data-activates="mobile-demo" class="button-collapse" id="subbar"><i class="material-icons">menu</i></a>
      <ul class="side-nav" id="mobile">
              <li><a href="{% url 'profile' %}#recommend" >Recommendations</a></li>
              <li><a href="{% url 'profile' %}#area" >Skills In Area</a></li>
      </ul>
      </div>
    </nav>
{% endcomment %}
{% comment %}
<h1>User Information</h1>
<form method="get"  action="{% url 'update_user' %}">
<button type="submit">Edit Information</button></form>
{{ address }}<br/>
{{ phone }}
    <h1>Skills you know</h1>
    {% for item in know %}
        {{ item.skill }}<form method="POST" action="{% url 'deleteknow' item.id %}">{% csrf_token %}<button type="submit" >Delete</button></form>
        Rank: {{ item.rank }}<br/>
        Description: {{ item.description }}
    {% endfor %}
    <h1>Skills you want to know</h1>
{% for item in learn %}
    {{ item.skill }}<form method="POST" action="{% url 'deletelearn' item.id %}">{% csrf_token %}<button type="submit" >Delete</button></form>
{% endfor %}
<br/>
      <ul class="collection with-header">
        <li class="collection-header"><h4>Matches</h4></li>
          {% for tu in exact %}<li style="text-align:center;">


<div class="left"  style="vertical-align: middle" > Skill: {{ tu.0.name }}</div>
    {% for user in tu.1 %}

<div class="center-align" align="center" style="display:inline-block;text-align:center;vertical-align: middle">User:<a href="{% url 'userpage' user.user.id %}" > {{ user.user }}</a></div>

<form class="right" method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <a class="waves-effect waves-light btn right" style=" height:8%;">Create Chat</a>
</form>
        {% endfor %}
{% endfor %}</li>

                {% for tu in similiar %}<li style="text-align:center;">


<div class="left"  style="vertical-align: middle" > Skill: {{ tu.2 }}</div>
    {% for user in tu.1 %}

<div class="center-align" align="center" style="display:inline-block;text-align:center;vertical-align: middle;">User:<a href="{% url 'userpage' user.user.id %}" > {{ user.user }}</a></div>

<form class="right" method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0; position:absolute">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <a class="waves-effect waves-light btn right" style=" height:8%;" >Create Chat</a>
</form>
        {% endfor %}
{% endfor %}</li>
      </ul>



      </ul>

      <ul class="collection" id="match" style="background:#0C93EB;border-color:#0C93EB;">
              <li class="collection-item avatar" style="padding-left:0;padding-right:0;background:#3D4BC4;border-color:#3D4BC4" ><h4 class="center-align" style="margin:0">Matches</h4></li>

        {% for tu in exact %}<li class="collection-item avatar" style="padding-left:0;padding-right:0;background:#0C93EB;">
            <div class="row" style="margin:0;">
<div class="col s4"  style="vertical-align: middle" > Skill: {{ tu.0.name }}</div>
    {% for user in tu.1 %}

<div class="col s4" style="text-align:center;: middle">User:<a href="{% url 'userpage' user.user.id %}" > {{ user.user }}</a></div>

<form class="right col s4" method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <button class="waves-effect waves-light btn right" >Create Chat</button>
</form>
        {% endfor %}
{% endfor %}</div></li>

                     {% for tu in similiar %}<li class="collection-item avatar" style="padding-left:0;padding-right:0;background:#3D4BC4;border-color:#3D4BC4">

<div class="row" style="margin:0;">

<div class="col s4"  style="vertical-align: middle" > Skill: {{ tu.2 }}</div>
    {% for user in tu.1 %}

<span class="col s4"  style="display:inline-block;text-align:center;vertical-align: middle;">User:<a href="{% url 'userpage' user.user.id %}" > {{ user.user }}</a></span>

<form class="col s4" method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0; ">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <button class="waves-effect waves-light btn right">Create Chat</button>
</form>
        {% endfor %}
{% endfor %}</div></li>
  </ul>

{% endcomment %}
 <div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
    <a class="btn-floating btn-large red">
      <i class="large material-icons">mode_edit</i>
    </a>
    <ul>
      <li><a class="btn-floating red" href="P{% url 'chatlist' %}"><i class="fa fa-comment"></i></a></li>
      <li><a class="btn-floating yellow darken-1" href="{% url 'addskill' %}"><i class="fa fa-university"></i></a></li>
    </ul>
  </div>


<div class="container">
{% if exact or similiar %}
{% else %}
<a href="{% url 'addskill' %}">
{% endif %}
      <div class="row">
        <div class="col s12 m12">
          <div class="card hoverable" style="background:#0E7787;">
            <div class="card-content white-text">
              <div class="card-title" style="text-align: center;">Matches</div>
{% if exact or similiar %}
    <div class="row" style="margin-top:15px;margin-bottom: 15px;">

<div class="left-align col s6 flow-text" >Skill</div>


<div class="right-align col s6 flow-text">
   <div>User</div>
    </div>
</div>
       <hr/>

{% for tu in exact %}
<div class="row" style="margin-top:15px;margin-bottom: 15px;">

<div class="left-align col s6" > {{ tu.0.name }}</div>


<div class="right-align col s6">
    {% for user in tu.1 %}
   <div><a href="{% url 'userpage' user.user.profile.id %}" style="color:white"> {{ user.user }}</a>
       <form  method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0;display:inline">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <button type="submit" style="background-color: Transparent;outline:none;border: none;"><i class="fa fa-comment"></i></button>
</form></div>
    {% endfor %}
</div></div><hr/>

{% endfor %}


{% for tu in similiar %}
<div class="row" style="margin-top:15px;margin-bottom: 15px;">

<div class="left-align col s6" >{{ tu.2 }}</div>

<div class="right-align col s6">
    {% for user in tu.1 %}
   <div><a href="{% url 'userpage' user.user.profile.id %}" style="color:white"> {{ user.user }}</a><form  method="POST" action="{% url 'userchatcreate'%}" style="vertical-align: middle; margin-bottom:0;display:inline;">{% csrf_token %}
        <input type="hidden" name="user2" value="{{ user.user }}"/>
        <button type="submit" style="background-color: Transparent;outline:none;border: none;"><i class="fa fa-comment"></i></button>
</form></div>
    {% endfor %}
    </div></div><hr/>
{% endfor %}
{% else %}
<h4>No Matches? <a style="color:white" href="{% url 'addskill' %}">Add more skills to learn and see if you get some</a></h4>
{% endif %}
</div>
</div>
</div>
            </div>
          </div>
        </div>
      </div>
{% if similiar or exact %}
{% else %}
</a>
{% endif %}
{% if user.profile.geo_enabled %}
{% else %}

<a href="{% url 'update_user' %}">
{% endif %}
<div class="row">
    <div class="col s6 m6" >
      <div class="card geotip hoverable" style="background:#007687;" data-position="bottom" data-delay="50" data-tooltip="Add your address to use">
        <div class="card-content white-text">
          <span class="card-title " ><h3 class="center-align">Skills in Area</h3></span>
{% if user.profile.geo_enabled %}
<form method="POST" action="{% url 'geo_skills' %}">{% csrf_token %}
    <select name="distance" style="visibility: visible;display:inline-block;background:#007687;">
        <option>10 Miles</option>
        <option>20 Miles</option>
        <option>30 Miles</option>
        <option>40 Miles</option>
        <option>50 Miles</option>
        <option>60 Miles</option>
        <option>70 Miles</option>
        <option>80 Miles</option>
        <option>90 Miles</option>
        <option>100 Miles</option>
    </select>
    <button type="submit" class="waves-effect blue accent-2 btn">Get Skills in Area</button>
    </form>
{% else %}

<div class="container">


    <p class="flow-text" style="color:white;"><a href="{% url 'update_user' %}">
        You must add your address to your profile to use this feature</a></p></div>
{% endif %}</div>
        <div class="card-action"><p class="flow-text">
{% for person in people %}

<div style="color:#424242;font-weight: 800 ;">User:<a href="{% url 'userpage' person.0.user.id %}" style="color:#424242"> {{ person.0.user }}</a></div>
<div style="color:whitesmoke; display:inline">Skills Available: </div>
{% for skill in person.1 %}
    <div style="color:whitesmoke;display:inline">{{ skill }}</div>
{% endfor %}
{% endfor %}
            </p>
            </div>
        </div>
      </div>
{% if user.profile.geo_enabled %}
{% else %}
</a>
{% endif %}


<div class="col s6 m6" >
      <div class="card" style="background:#007687;">
        <div class="card-content white-text">
          <span class="card-title"><h3 class="center-align">You may also like</h3></span>
        </div>
        <div class="card-action flow-text center-align" style="font-weight: 600; color:whitesmoke">
{% if recommendation %}
{% for item in recommendation %}
<p>{{ item }}
    <input id='learn' type="hidden" name="skill" value="learn"  />
  <input  type="hidden" id="name{{ item.id }}" value="{{ item }}">
  <input  type="hidden" id="user{{ request.user.id }}" value="{{ request.user.id }}">
    <input type="hidden" id="description{{ item.id }}" placeholder="Description" value="nodescription"/>
        <button class="learn{{ item.id }}" style="background-color: Transparent;outline:none;border: none;">
            <i class="fa fa-plus"></i>
        </button></p>

    <script>

var learnskill{{ item.id }} = function(){
var token = $('input[name=csrfmiddlewaretoken]').val();
var learn = document.getElementById("learn").value;
var skill = document.getElementById("name{{ item.id }}").value;
var user = document.getElementById("user{{ request.user.id }}").value;
var description = document.getElementById("description{{ item.id }}").value;
$.ajax({
  type: 'POST',
  url: {% url 'addlearnapi' %},
  data: {'skill': skill, "learn": learn, "description": description, "user": user, 'csrfmiddlewaretoken': token}
  });
    Materialize.toast('Added {{ item }} To Learn', 3000)
};


$(document).ready(function(){
$(".learn{{ item.id }}").click(learnskill{{ item.id }});


});
 </script>





    </p>
{% endfor %}
        {% else %}
        <p class="flow-text">Recommendations will appear here as they are calculated</p>
        {% endif %}
        </div>
      </div>
    </div>
</div>



<script>

    $(document).ready(function(){ // document ready



{% if exact or similiar %}
            {% else %}
Materialize.toast("<span>You don't have any matches</span><a class='btn-flat yellow-text'; href='{% url 'addskill' %}';>Add Skills<a>", 4000);
        {% endif %}


{% if user.profile.geo_enabled %}
{% else %}
$('.geotip').tooltip({delay: 50});
{% endif %}



});


</script>
</body>
{% endblock %}
</html>